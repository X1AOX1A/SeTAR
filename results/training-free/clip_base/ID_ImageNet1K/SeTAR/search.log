2024-06-16 04:56:15,804 | INFO | argparser.py:195 | print_args | Loading args from config file: configs/training_free/clip_base/ID_ImageNet/SeTAR.json
2024-06-16 04:56:15,805 | INFO | argparser.py:198 | print_args | Config: 
{
    "data_root": "/data/DATASETS/SVD_OOD",
    "id_dataset": "ID_ImageNet1K",
    "split": "val",
    "batch_size": 512,
    "seed": 5,
    "device": "cuda",
    "exp_name": "SeTAR",
    "log_directory": "./results/training-free/clip_base/ID_ImageNet1K/SeTAR",
    "scorers": [
        "loss"
    ],
    "temperature": 100,
    "recall_level": 0.95,
    "model_name": "openai/clip-vit-base-patch16",
    "model_type": "CLIP",
    "clip_ckpt": null,
    "locoop_ckpt": null,
    "lora_svd_init": true,
    "lora_svd_init_type": "small",
    "lora_settings": null,
    "target_modules": null,
    "lora_r": null,
    "lora_alpha": null,
    "n_ctx": 16,
    "searcher": "visual_text",
    "candi_ratios": [
        0,
        0.05,
        0.1,
        0.15,
        0.2,
        0.25,
        0.3,
        0.35,
        0.4
    ],
    "weight_type": "W_up",
    "best_scorer": "loss",
    "best_metric": "locoop_loss",
    "freeze_proj": true,
    "locoop_lambda": 0.1,
    "locoop_top_k": 300,
    "use_pred_label": false
}
2024-06-16 04:56:15,808 | INFO | searchers.py:66 | __init__ | Best scorer: loss
2024-06-16 04:56:15,808 | INFO | searchers.py:67 | __init__ | Best metric: locoop_loss
2024-06-16 04:56:15,808 | INFO | searchers.py:33 | __init__ | ############ Searcher Created ############
2024-06-16 04:56:15,808 | INFO | searchers.py:34 | __init__ | Searcher: visual_text
2024-06-16 04:56:15,808 | INFO | searchers.py:172 | run | Start searching low rank configs...
2024-06-16 04:57:15,985 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183

2024-06-16 04:58:15,808 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082

2024-06-16 04:59:16,297 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082

2024-06-16 05:00:17,185 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082

2024-06-16 05:01:18,350 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082

2024-06-16 05:02:19,570 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082

2024-06-16 05:03:20,025 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082

2024-06-16 05:04:20,591 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082

2024-06-16 05:05:22,799 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510

2024-06-16 05:06:23,491 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510

2024-06-16 05:07:24,161 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510

2024-06-16 05:08:24,598 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734

2024-06-16 05:09:27,129 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734

2024-06-16 05:10:28,165 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734

2024-06-16 05:11:29,665 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
14         text        W_up          9        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734

2024-06-16 05:12:31,605 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
14         text        W_up          9        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
15         text        W_up          8        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734

2024-06-16 05:13:33,611 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
14         text        W_up          9        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
15         text        W_up          8        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
16         text        W_up          7        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734

2024-06-16 05:14:35,637 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
14         text        W_up          9        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
15         text        W_up          8        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
16         text        W_up          7        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
17         text        W_up          6        0.25      0.631738  1.075123 -4.433849  71.600001          38.647449

2024-06-16 05:15:38,635 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
14         text        W_up          9        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
15         text        W_up          8        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
16         text        W_up          7        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
17         text        W_up          6        0.25      0.631738  1.075123 -4.433849  71.600001          38.647449
18         text        W_up          5        0.10      0.631510  1.078703 -4.471925  71.599997          38.209182

2024-06-16 05:16:42,037 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
14         text        W_up          9        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
15         text        W_up          8        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
16         text        W_up          7        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
17         text        W_up          6        0.25      0.631738  1.075123 -4.433849  71.600001          38.647449
18         text        W_up          5        0.10      0.631510  1.078703 -4.471925  71.599997          38.209182
19         text        W_up          4        0.20      0.622934  1.075958 -4.530243  72.000001          38.419898

2024-06-16 05:17:46,464 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
14         text        W_up          9        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
15         text        W_up          8        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
16         text        W_up          7        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
17         text        W_up          6        0.25      0.631738  1.075123 -4.433849  71.600001          38.647449
18         text        W_up          5        0.10      0.631510  1.078703 -4.471925  71.599997          38.209182
19         text        W_up          4        0.20      0.622934  1.075958 -4.530243  72.000001          38.419898
20         text        W_up          3        0.05      0.621230  1.079326 -4.580955  71.999997          38.419897

2024-06-16 05:18:50,502 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
14         text        W_up          9        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
15         text        W_up          8        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
16         text        W_up          7        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
17         text        W_up          6        0.25      0.631738  1.075123 -4.433849  71.600001          38.647449
18         text        W_up          5        0.10      0.631510  1.078703 -4.471925  71.599997          38.209182
19         text        W_up          4        0.20      0.622934  1.075958 -4.530243  72.000001          38.419898
20         text        W_up          3        0.05      0.621230  1.079326 -4.580955  71.999997          38.419897
21         text        W_up          2        0.05      0.619341  1.076858 -4.575174  71.600001          38.429082

2024-06-16 05:19:53,678 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
14         text        W_up          9        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
15         text        W_up          8        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
16         text        W_up          7        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
17         text        W_up          6        0.25      0.631738  1.075123 -4.433849  71.600001          38.647449
18         text        W_up          5        0.10      0.631510  1.078703 -4.471925  71.599997          38.209182
19         text        W_up          4        0.20      0.622934  1.075958 -4.530243  72.000001          38.419898
20         text        W_up          3        0.05      0.621230  1.079326 -4.580955  71.999997          38.419897
21         text        W_up          2        0.05      0.619341  1.076858 -4.575174  71.600001          38.429082
22         text        W_up          1        0.00      0.619341  1.076858 -4.575174  71.600001          38.429082

2024-06-16 05:20:57,268 | INFO | searchers.py:202 | run | Current best settings: 
     tower_type weight_type  layer_num  best_ratio  locoop_loss*   loss_id  loss_ood        acc  ood_patch_percent
step                                                                                                              
0        visual        W_up         11        0.15      0.648611  1.093326 -4.447154  71.399998          38.759183
1        visual        W_up         10        0.15      0.645630  1.083629 -4.379990  71.799998          38.979082
2        visual        W_up          9        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
3        visual        W_up          8        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
4        visual        W_up          7        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
5        visual        W_up          6        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
6        visual        W_up          5        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
7        visual        W_up          4        0.00      0.645630  1.083629 -4.379990  71.799998          38.979082
8        visual        W_up          3        0.05      0.641744  1.079729 -4.379844  71.999998          39.000510
9        visual        W_up          2        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
10       visual        W_up          1        0.00      0.641744  1.079729 -4.379844  71.999998          39.000510
11       visual        W_up          0        0.15      0.641135  1.079109 -4.379746  72.199998          38.986734
12         text        W_up         11        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
13         text        W_up         10        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
14         text        W_up          9        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
15         text        W_up          8        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
16         text        W_up          7        0.00      0.641135  1.079109 -4.379746  72.199998          38.986734
17         text        W_up          6        0.25      0.631738  1.075123 -4.433849  71.600001          38.647449
18         text        W_up          5        0.10      0.631510  1.078703 -4.471925  71.599997          38.209182
19         text        W_up          4        0.20      0.622934  1.075958 -4.530243  72.000001          38.419898
20         text        W_up          3        0.05      0.621230  1.079326 -4.580955  71.999997          38.419897
21         text        W_up          2        0.05      0.619341  1.076858 -4.575174  71.600001          38.429082
22         text        W_up          1        0.00      0.619341  1.076858 -4.575174  71.600001          38.429082
23         text        W_up          0        0.20      0.615867  1.069851 -4.539846  72.499997          38.671938

2024-06-16 05:20:57,275 | INFO | searchers.py:208 | run | Best low rank configs: 
[['visual', 'W_up', 11, 0.15], ['visual', 'W_up', 10, 0.15], ['visual', 'W_up', 9, 0], ['visual', 'W_up', 8, 0], ['visual', 'W_up', 7, 0], ['visual', 'W_up', 6, 0], ['visual', 'W_up', 5, 0], ['visual', 'W_up', 4, 0], ['visual', 'W_up', 3, 0.05], ['visual', 'W_up', 2, 0], ['visual', 'W_up', 1, 0], ['visual', 'W_up', 0, 0.15], ['text', 'W_up', 11, 0], ['text', 'W_up', 10, 0], ['text', 'W_up', 9, 0], ['text', 'W_up', 8, 0], ['text', 'W_up', 7, 0], ['text', 'W_up', 6, 0.25], ['text', 'W_up', 5, 0.1], ['text', 'W_up', 4, 0.2], ['text', 'W_up', 3, 0.05], ['text', 'W_up', 2, 0.05], ['text', 'W_up', 1, 0], ['text', 'W_up', 0, 0.2]]
2024-06-16 05:20:57,275 | INFO | searchers.py:211 | run | ############ Done! Search time: 24m 41s ############
2024-06-16 05:20:57,276 | INFO | test_ood.py:29 | run_test_ood | ############ Test OOD Detection ############
2024-06-16 05:20:57,276 | INFO | test_ood.py:30 | run_test_ood | Loading CLIP model: openai/clip-vit-base-patch16...
2024-06-16 05:20:57,775 | INFO | test_ood.py:39 | run_test_ood | Applying SVD prune to 'small' weights...
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.11.mlp.fc1] [rank(115)=round(full_rank(768)*rank_ratio(0.15))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.10.mlp.fc1] [rank(115)=round(full_rank(768)*rank_ratio(0.15))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.9.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.8.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.7.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.6.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.5.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.4.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.3.mlp.fc1] [rank(38)=round(full_rank(768)*rank_ratio(0.05))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.2.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.1.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.0.mlp.fc1] [rank(115)=round(full_rank(768)*rank_ratio(0.15))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.11.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.10.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.9.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.8.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.7.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.6.mlp.fc1] [rank(128)=round(full_rank(512)*rank_ratio(0.25))]
2024-06-16 05:20:57,778 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.5.mlp.fc1] [rank(51)=round(full_rank(512)*rank_ratio(0.1))]
2024-06-16 05:20:57,779 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.4.mlp.fc1] [rank(102)=round(full_rank(512)*rank_ratio(0.2))]
2024-06-16 05:20:57,779 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.3.mlp.fc1] [rank(26)=round(full_rank(512)*rank_ratio(0.05))]
2024-06-16 05:20:57,779 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.2.mlp.fc1] [rank(26)=round(full_rank(512)*rank_ratio(0.05))]
2024-06-16 05:20:57,779 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.1.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:20:57,779 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.0.mlp.fc1] [rank(102)=round(full_rank(512)*rank_ratio(0.2))]
2024-06-16 05:20:57,779 | INFO | model_hub.py:194 | to_target_modules | lora_settings -> target_modules: 
{
    "vision_model.encoder.layers.11.mlp.fc1": 115,
    "vision_model.encoder.layers.10.mlp.fc1": 115,
    "vision_model.encoder.layers.9.mlp.fc1": 0,
    "vision_model.encoder.layers.8.mlp.fc1": 0,
    "vision_model.encoder.layers.7.mlp.fc1": 0,
    "vision_model.encoder.layers.6.mlp.fc1": 0,
    "vision_model.encoder.layers.5.mlp.fc1": 0,
    "vision_model.encoder.layers.4.mlp.fc1": 0,
    "vision_model.encoder.layers.3.mlp.fc1": 38,
    "vision_model.encoder.layers.2.mlp.fc1": 0,
    "vision_model.encoder.layers.1.mlp.fc1": 0,
    "vision_model.encoder.layers.0.mlp.fc1": 115,
    "text_model.encoder.layers.11.mlp.fc1": 0,
    "text_model.encoder.layers.10.mlp.fc1": 0,
    "text_model.encoder.layers.9.mlp.fc1": 0,
    "text_model.encoder.layers.8.mlp.fc1": 0,
    "text_model.encoder.layers.7.mlp.fc1": 0,
    "text_model.encoder.layers.6.mlp.fc1": 128,
    "text_model.encoder.layers.5.mlp.fc1": 51,
    "text_model.encoder.layers.4.mlp.fc1": 102,
    "text_model.encoder.layers.3.mlp.fc1": 26,
    "text_model.encoder.layers.2.mlp.fc1": 26,
    "text_model.encoder.layers.1.mlp.fc1": 0,
    "text_model.encoder.layers.0.mlp.fc1": 102
}
2024-06-16 05:20:57,784 | INFO | model.py:78 | inject_adapter | [vision_model.encoder.layers.11.mlp.fc1] [Rank: 115]
2024-06-16 05:20:57,788 | INFO | model.py:78 | inject_adapter | [vision_model.encoder.layers.10.mlp.fc1] [Rank: 115]
2024-06-16 05:20:57,788 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.9.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,788 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.8.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,788 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.7.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,789 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.6.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,789 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.5.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,789 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.4.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,790 | INFO | model.py:78 | inject_adapter | [vision_model.encoder.layers.3.mlp.fc1] [Rank: 38]
2024-06-16 05:20:57,790 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.2.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,790 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.1.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,794 | INFO | model.py:78 | inject_adapter | [vision_model.encoder.layers.0.mlp.fc1] [Rank: 115]
2024-06-16 05:20:57,794 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.11.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,794 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.10.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,794 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.9.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,795 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.8.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,795 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.7.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,798 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.6.mlp.fc1] [Rank: 128]
2024-06-16 05:20:57,799 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.5.mlp.fc1] [Rank: 51]
2024-06-16 05:20:57,802 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.4.mlp.fc1] [Rank: 102]
2024-06-16 05:20:57,803 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.3.mlp.fc1] [Rank: 26]
2024-06-16 05:20:57,804 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.2.mlp.fc1] [Rank: 26]
2024-06-16 05:20:57,804 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.1.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:20:57,807 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.0.mlp.fc1] [Rank: 102]
2024-06-16 05:20:58,048 | INFO | model.py:192 | svd_init | SVD initialized for adapter 'default'.
2024-06-16 05:20:58,208 | INFO | test_ood.py:63 | run_test_ood | ############ ID dataset: ID_ImageNet1K, test set: 50000 images ############
2024-06-16 05:20:58,208 | INFO | test_ood.py:65 | run_test_ood | Computing scores for ID_ImageNet1K...
2024-06-16 05:23:16,403 | INFO | model_hub.py:304 | compute_scores | Took 138.19 s to run.
2024-06-16 05:23:16,574 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_iNaturalist, test set: 10000 images ############
2024-06-16 05:23:16,575 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_iNaturalist...
2024-06-16 05:23:49,537 | INFO | model_hub.py:304 | compute_scores | Took 32.96 s to run.
2024-06-16 05:23:49,608 | INFO | metrics.py:55 | print_metrics | OOD_iNaturalist - mcm_score
2024-06-16 05:23:49,608 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:23:49,608 | INFO | metrics.py:57 | print_metrics | & 26.92 & 94.67 & 98.81
2024-06-16 05:23:50,359 | INFO | metrics.py:55 | print_metrics | OOD_iNaturalist - gl_mcm_score
2024-06-16 05:23:50,359 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:23:50,359 | INFO | metrics.py:57 | print_metrics | & 13.36 & 96.92 & 99.28
2024-06-16 05:23:51,159 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_Sun, test set: 10000 images ############
2024-06-16 05:23:51,159 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_Sun...
2024-06-16 05:24:25,712 | INFO | model_hub.py:304 | compute_scores | Took 34.55 s to run.
2024-06-16 05:24:25,786 | INFO | metrics.py:55 | print_metrics | OOD_Sun - mcm_score
2024-06-16 05:24:25,786 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:24:25,786 | INFO | metrics.py:57 | print_metrics | & 35.57 & 92.79 & 98.34
2024-06-16 05:24:26,670 | INFO | metrics.py:55 | print_metrics | OOD_Sun - gl_mcm_score
2024-06-16 05:24:26,670 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:24:26,670 | INFO | metrics.py:57 | print_metrics | & 28.17 & 93.36 & 98.34
2024-06-16 05:24:27,378 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_Places, test set: 10000 images ############
2024-06-16 05:24:27,378 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_Places...
2024-06-16 05:24:58,452 | INFO | model_hub.py:304 | compute_scores | Took 31.07 s to run.
2024-06-16 05:24:58,523 | INFO | metrics.py:55 | print_metrics | OOD_Places - mcm_score
2024-06-16 05:24:58,524 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:24:58,524 | INFO | metrics.py:57 | print_metrics | & 42.64 & 90.16 & 97.59
2024-06-16 05:24:59,297 | INFO | metrics.py:55 | print_metrics | OOD_Places - gl_mcm_score
2024-06-16 05:24:59,297 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:24:59,297 | INFO | metrics.py:57 | print_metrics | & 36.80 & 90.40 & 97.52
2024-06-16 05:24:59,997 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_Texture, test set: 5640 images ############
2024-06-16 05:24:59,997 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_Texture...
2024-06-16 05:25:18,492 | INFO | model_hub.py:304 | compute_scores | Took 18.49 s to run.
2024-06-16 05:25:18,550 | INFO | metrics.py:55 | print_metrics | OOD_Texture - mcm_score
2024-06-16 05:25:18,551 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:25:18,551 | INFO | metrics.py:57 | print_metrics | & 55.83 & 86.58 & 98.11
2024-06-16 05:25:19,272 | INFO | metrics.py:55 | print_metrics | OOD_Texture - gl_mcm_score
2024-06-16 05:25:19,272 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:25:19,272 | INFO | metrics.py:57 | print_metrics | & 54.17 & 84.59 & 97.58
2024-06-16 05:25:19,952 | INFO | test_ood.py:98 | run_test_ood | ############ Metrics for mcm_score ############
2024-06-16 05:25:19,955 | INFO | metrics.py:76 | save_metrics | ############ Mean metrics ############
2024-06-16 05:25:19,956 | INFO | metrics.py:77 | save_metrics | 
                 FPR95  AUROC  AUPR
OOD dataset                        
OOD_iNaturalist  26.92  94.67 98.81
OOD_Sun          35.57  92.79 98.34
OOD_Places       42.64  90.16 97.59
OOD_Texture      55.83  86.58 98.11
Avg              40.24  91.05 98.21
2024-06-16 05:25:19,956 | INFO | metrics.py:78 | save_metrics | Metrics saved to ./results/training-free/clip_base/ID_ImageNet1K/SeTAR/metrics_mcm_score_test.csv
2024-06-16 05:25:19,957 | INFO | metrics.py:87 | save_cutoffs | ############ Thresholds Cut-off ############
2024-06-16 05:25:19,958 | INFO | metrics.py:88 | save_cutoffs | 
    OOD dataset   Cutoff
OOD_iNaturalist 0.001096
        OOD_Sun 0.001096
     OOD_Places 0.001096
    OOD_Texture 0.001096
2024-06-16 05:25:19,958 | INFO | metrics.py:89 | save_cutoffs | Thresholds cutoff saved to ./results/training-free/clip_base/ID_ImageNet1K/SeTAR/cutoffs_mcm_score_test.csv
2024-06-16 05:25:19,958 | INFO | test_ood.py:98 | run_test_ood | ############ Metrics for gl_mcm_score ############
2024-06-16 05:25:19,960 | INFO | metrics.py:76 | save_metrics | ############ Mean metrics ############
2024-06-16 05:25:19,960 | INFO | metrics.py:77 | save_metrics | 
                 FPR95  AUROC  AUPR
OOD dataset                        
OOD_iNaturalist  13.36  96.92 99.28
OOD_Sun          28.17  93.36 98.34
OOD_Places       36.80  90.40 97.52
OOD_Texture      54.17  84.59 97.58
Avg              33.12  91.32 98.18
2024-06-16 05:25:19,960 | INFO | metrics.py:78 | save_metrics | Metrics saved to ./results/training-free/clip_base/ID_ImageNet1K/SeTAR/metrics_gl_mcm_score_test.csv
2024-06-16 05:25:19,961 | INFO | metrics.py:87 | save_cutoffs | ############ Thresholds Cut-off ############
2024-06-16 05:25:19,962 | INFO | metrics.py:88 | save_cutoffs | 
    OOD dataset   Cutoff
OOD_iNaturalist 0.002232
        OOD_Sun 0.002232
     OOD_Places 0.002232
    OOD_Texture 0.002232
2024-06-16 05:25:19,962 | INFO | metrics.py:89 | save_cutoffs | Thresholds cutoff saved to ./results/training-free/clip_base/ID_ImageNet1K/SeTAR/cutoffs_gl_mcm_score_test.csv
2024-06-16 05:25:19,962 | INFO | test_ood.py:107 | run_test_ood | ############ Done! Test time: 4m 23s ############
2024-06-16 05:25:19,962 | INFO | test_classify.py:121 | run_test_classify | ############ Test Classification ############
2024-06-16 05:25:19,962 | INFO | test_classify.py:122 | run_test_classify | Loading CLIP model: openai/clip-vit-base-patch16...
2024-06-16 05:25:20,545 | INFO | test_classify.py:131 | run_test_classify | Applying SVD prune to 'small' weights...
2024-06-16 05:25:20,548 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.11.mlp.fc1] [rank(115)=round(full_rank(768)*rank_ratio(0.15))]
2024-06-16 05:25:20,548 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.10.mlp.fc1] [rank(115)=round(full_rank(768)*rank_ratio(0.15))]
2024-06-16 05:25:20,548 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.9.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:25:20,548 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.8.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:25:20,548 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.7.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:25:20,548 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.6.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:25:20,548 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.5.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.4.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.3.mlp.fc1] [rank(38)=round(full_rank(768)*rank_ratio(0.05))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.2.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.1.mlp.fc1] [rank(0)=round(full_rank(768)*rank_ratio(0))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [vision_model.encoder.layers.0.mlp.fc1] [rank(115)=round(full_rank(768)*rank_ratio(0.15))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.11.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.10.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.9.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.8.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.7.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.6.mlp.fc1] [rank(128)=round(full_rank(512)*rank_ratio(0.25))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.5.mlp.fc1] [rank(51)=round(full_rank(512)*rank_ratio(0.1))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.4.mlp.fc1] [rank(102)=round(full_rank(512)*rank_ratio(0.2))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.3.mlp.fc1] [rank(26)=round(full_rank(512)*rank_ratio(0.05))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.2.mlp.fc1] [rank(26)=round(full_rank(512)*rank_ratio(0.05))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.1.mlp.fc1] [rank(0)=round(full_rank(512)*rank_ratio(0))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:190 | to_target_modules | [text_model.encoder.layers.0.mlp.fc1] [rank(102)=round(full_rank(512)*rank_ratio(0.2))]
2024-06-16 05:25:20,549 | INFO | model_hub.py:194 | to_target_modules | lora_settings -> target_modules: 
{
    "vision_model.encoder.layers.11.mlp.fc1": 115,
    "vision_model.encoder.layers.10.mlp.fc1": 115,
    "vision_model.encoder.layers.9.mlp.fc1": 0,
    "vision_model.encoder.layers.8.mlp.fc1": 0,
    "vision_model.encoder.layers.7.mlp.fc1": 0,
    "vision_model.encoder.layers.6.mlp.fc1": 0,
    "vision_model.encoder.layers.5.mlp.fc1": 0,
    "vision_model.encoder.layers.4.mlp.fc1": 0,
    "vision_model.encoder.layers.3.mlp.fc1": 38,
    "vision_model.encoder.layers.2.mlp.fc1": 0,
    "vision_model.encoder.layers.1.mlp.fc1": 0,
    "vision_model.encoder.layers.0.mlp.fc1": 115,
    "text_model.encoder.layers.11.mlp.fc1": 0,
    "text_model.encoder.layers.10.mlp.fc1": 0,
    "text_model.encoder.layers.9.mlp.fc1": 0,
    "text_model.encoder.layers.8.mlp.fc1": 0,
    "text_model.encoder.layers.7.mlp.fc1": 0,
    "text_model.encoder.layers.6.mlp.fc1": 128,
    "text_model.encoder.layers.5.mlp.fc1": 51,
    "text_model.encoder.layers.4.mlp.fc1": 102,
    "text_model.encoder.layers.3.mlp.fc1": 26,
    "text_model.encoder.layers.2.mlp.fc1": 26,
    "text_model.encoder.layers.1.mlp.fc1": 0,
    "text_model.encoder.layers.0.mlp.fc1": 102
}
2024-06-16 05:25:20,555 | INFO | model.py:78 | inject_adapter | [vision_model.encoder.layers.11.mlp.fc1] [Rank: 115]
2024-06-16 05:25:20,559 | INFO | model.py:78 | inject_adapter | [vision_model.encoder.layers.10.mlp.fc1] [Rank: 115]
2024-06-16 05:25:20,560 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.9.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,560 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.8.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,560 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.7.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,560 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.6.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,560 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.5.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,560 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.4.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,562 | INFO | model.py:78 | inject_adapter | [vision_model.encoder.layers.3.mlp.fc1] [Rank: 38]
2024-06-16 05:25:20,562 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.2.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,562 | INFO | model.py:71 | inject_adapter | [vision_model.encoder.layers.1.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,566 | INFO | model.py:78 | inject_adapter | [vision_model.encoder.layers.0.mlp.fc1] [Rank: 115]
2024-06-16 05:25:20,566 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.11.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,566 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.10.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,566 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.9.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,566 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.8.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,566 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.7.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,570 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.6.mlp.fc1] [Rank: 128]
2024-06-16 05:25:20,571 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.5.mlp.fc1] [Rank: 51]
2024-06-16 05:25:20,574 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.4.mlp.fc1] [Rank: 102]
2024-06-16 05:25:20,575 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.3.mlp.fc1] [Rank: 26]
2024-06-16 05:25:20,576 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.2.mlp.fc1] [Rank: 26]
2024-06-16 05:25:20,576 | INFO | model.py:71 | inject_adapter | [text_model.encoder.layers.1.mlp.fc1] [Rank: 0] [Skipped]
2024-06-16 05:25:20,579 | INFO | model.py:78 | inject_adapter | [text_model.encoder.layers.0.mlp.fc1] [Rank: 102]
2024-06-16 05:25:20,841 | INFO | model.py:192 | svd_init | SVD initialized for adapter 'default'.
2024-06-16 05:25:20,863 | INFO | test_classify.py:151 | run_test_classify | ############ ID_ImageNet1K ############
2024-06-16 05:27:33,760 | INFO | test_classify.py:161 | run_test_classify | Accuracy on ID_ImageNet1K: 63.97
2024-06-16 05:27:33,760 | INFO | test_classify.py:151 | run_test_classify | ############ OOD_Sun ############
2024-06-16 05:28:07,914 | INFO | test_classify.py:161 | run_test_classify | Accuracy on OOD_Sun: 75.50
2024-06-16 05:28:07,914 | INFO | test_classify.py:151 | run_test_classify | ############ OOD_Places ############
2024-06-16 05:28:35,354 | INFO | test_classify.py:161 | run_test_classify | Accuracy on OOD_Places: 45.81
2024-06-16 05:28:35,355 | INFO | test_classify.py:151 | run_test_classify | ############ OOD_Texture ############
2024-06-16 05:28:52,215 | INFO | test_classify.py:161 | run_test_classify | Accuracy on OOD_Texture: 43.76
2024-06-16 05:28:52,216 | INFO | test_classify.py:164 | run_test_classify | ############ Summary ############
2024-06-16 05:28:52,216 | INFO | test_classify.py:166 | run_test_classify | Accuracy on ID_ImageNet1K: 63.97
2024-06-16 05:28:52,216 | INFO | test_classify.py:166 | run_test_classify | Accuracy on OOD_Sun: 75.50
2024-06-16 05:28:52,216 | INFO | test_classify.py:166 | run_test_classify | Accuracy on OOD_Places: 45.81
2024-06-16 05:28:52,216 | INFO | test_classify.py:166 | run_test_classify | Accuracy on OOD_Texture: 43.76
