2024-06-16 05:03:56,746 | INFO | test_ood.py:29 | run_test_ood | ############ Test OOD Detection ############
2024-06-16 05:03:56,746 | INFO | test_ood.py:30 | run_test_ood | Loading CLIP model: openai/clip-vit-large-patch14...
2024-06-16 05:03:57,248 | INFO | test_ood.py:45 | run_test_ood | Loading CLIP model weights from ./results/finetune/clip_large/ID_ImageNet1K/LoRA/finetuned_model.pth...
2024-06-16 05:03:58,098 | INFO | test_ood.py:63 | run_test_ood | ############ ID dataset: ID_ImageNet1K, test set: 50000 images ############
2024-06-16 05:03:58,098 | INFO | test_ood.py:65 | run_test_ood | Computing scores for ID_ImageNet1K...
2024-06-16 05:12:56,185 | INFO | model_hub.py:304 | compute_scores | Took 538.09 s to run.
2024-06-16 05:12:56,356 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_iNaturalist, test set: 10000 images ############
2024-06-16 05:12:56,356 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_iNaturalist...
2024-06-16 05:14:44,828 | INFO | model_hub.py:304 | compute_scores | Took 108.47 s to run.
2024-06-16 05:14:44,902 | INFO | metrics.py:55 | print_metrics | OOD_iNaturalist - mcm_score
2024-06-16 05:14:44,903 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:14:44,903 | INFO | metrics.py:57 | print_metrics | & 34.63 & 93.64 & 98.63
2024-06-16 05:14:45,839 | INFO | metrics.py:55 | print_metrics | OOD_iNaturalist - gl_mcm_score
2024-06-16 05:14:45,839 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:14:45,839 | INFO | metrics.py:57 | print_metrics | & 41.16 & 91.94 & 98.19
2024-06-16 05:14:46,652 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_Sun, test set: 10000 images ############
2024-06-16 05:14:46,653 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_Sun...
2024-06-16 05:16:35,769 | INFO | model_hub.py:304 | compute_scores | Took 109.12 s to run.
2024-06-16 05:16:35,892 | INFO | metrics.py:55 | print_metrics | OOD_Sun - mcm_score
2024-06-16 05:16:35,892 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:16:35,892 | INFO | metrics.py:57 | print_metrics | & 29.74 & 94.21 & 98.73
2024-06-16 05:16:36,729 | INFO | metrics.py:55 | print_metrics | OOD_Sun - gl_mcm_score
2024-06-16 05:16:36,730 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:16:36,730 | INFO | metrics.py:57 | print_metrics | & 31.87 & 93.84 & 98.60
2024-06-16 05:16:37,522 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_Places, test set: 10000 images ############
2024-06-16 05:16:37,522 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_Places...
2024-06-16 05:18:26,049 | INFO | model_hub.py:304 | compute_scores | Took 108.53 s to run.
2024-06-16 05:18:26,126 | INFO | metrics.py:55 | print_metrics | OOD_Places - mcm_score
2024-06-16 05:18:26,126 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:18:26,126 | INFO | metrics.py:57 | print_metrics | & 36.44 & 91.60 & 97.92
2024-06-16 05:18:26,999 | INFO | metrics.py:55 | print_metrics | OOD_Places - gl_mcm_score
2024-06-16 05:18:26,999 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:18:26,999 | INFO | metrics.py:57 | print_metrics | & 39.54 & 90.80 & 97.68
2024-06-16 05:18:27,839 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_Texture, test set: 5640 images ############
2024-06-16 05:18:27,840 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_Texture...
2024-06-16 05:19:29,339 | INFO | model_hub.py:304 | compute_scores | Took 61.5 s to run.
2024-06-16 05:19:29,400 | INFO | metrics.py:55 | print_metrics | OOD_Texture - mcm_score
2024-06-16 05:19:29,400 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:19:29,400 | INFO | metrics.py:57 | print_metrics | & 53.35 & 87.24 & 98.20
2024-06-16 05:19:30,184 | INFO | metrics.py:55 | print_metrics | OOD_Texture - gl_mcm_score
2024-06-16 05:19:30,184 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:19:30,184 | INFO | metrics.py:57 | print_metrics | & 61.10 & 82.59 & 97.35
2024-06-16 05:19:30,838 | INFO | test_ood.py:98 | run_test_ood | ############ Metrics for mcm_score ############
2024-06-16 05:19:30,841 | INFO | metrics.py:76 | save_metrics | ############ Mean metrics ############
2024-06-16 05:19:30,842 | INFO | metrics.py:77 | save_metrics | 
                 FPR95  AUROC  AUPR
OOD dataset                        
OOD_iNaturalist  34.63  93.64 98.63
OOD_Sun          29.74  94.21 98.73
OOD_Places       36.44  91.60 97.92
OOD_Texture      53.35  87.24 98.20
Avg              38.54  91.67 98.37
2024-06-16 05:19:30,843 | INFO | metrics.py:78 | save_metrics | Metrics saved to ./results/finetune/clip_large/ID_ImageNet1K/LoRA/metrics_mcm_score_test.csv
2024-06-16 05:19:30,844 | INFO | metrics.py:87 | save_cutoffs | ############ Thresholds Cut-off ############
2024-06-16 05:19:30,845 | INFO | metrics.py:88 | save_cutoffs | 
    OOD dataset   Cutoff
OOD_iNaturalist 0.001078
        OOD_Sun 0.001078
     OOD_Places 0.001078
    OOD_Texture 0.001078
2024-06-16 05:19:30,845 | INFO | metrics.py:89 | save_cutoffs | Thresholds cutoff saved to ./results/finetune/clip_large/ID_ImageNet1K/LoRA/cutoffs_mcm_score_test.csv
2024-06-16 05:19:30,845 | INFO | test_ood.py:98 | run_test_ood | ############ Metrics for gl_mcm_score ############
2024-06-16 05:19:30,847 | INFO | metrics.py:76 | save_metrics | ############ Mean metrics ############
2024-06-16 05:19:30,848 | INFO | metrics.py:77 | save_metrics | 
                 FPR95  AUROC  AUPR
OOD dataset                        
OOD_iNaturalist  41.16  91.94 98.19
OOD_Sun          31.87  93.84 98.60
OOD_Places       39.54  90.80 97.68
OOD_Texture      61.10  82.59 97.35
Avg              43.42  89.79 97.95
2024-06-16 05:19:30,848 | INFO | metrics.py:78 | save_metrics | Metrics saved to ./results/finetune/clip_large/ID_ImageNet1K/LoRA/metrics_gl_mcm_score_test.csv
2024-06-16 05:19:30,848 | INFO | metrics.py:87 | save_cutoffs | ############ Thresholds Cut-off ############
2024-06-16 05:19:30,849 | INFO | metrics.py:88 | save_cutoffs | 
    OOD dataset  Cutoff
OOD_iNaturalist 0.00217
        OOD_Sun 0.00217
     OOD_Places 0.00217
    OOD_Texture 0.00217
2024-06-16 05:19:30,849 | INFO | metrics.py:89 | save_cutoffs | Thresholds cutoff saved to ./results/finetune/clip_large/ID_ImageNet1K/LoRA/cutoffs_gl_mcm_score_test.csv
2024-06-16 05:19:30,849 | INFO | test_ood.py:107 | run_test_ood | ############ Done! Test time: 15m 34s ############
2024-06-16 05:19:30,849 | INFO | test_classify.py:121 | run_test_classify | ############ Test Classification ############
2024-06-16 05:19:30,850 | INFO | test_classify.py:122 | run_test_classify | Loading CLIP model: openai/clip-vit-large-patch14...
2024-06-16 05:19:31,572 | INFO | test_classify.py:137 | run_test_classify | Loading clip model weights from ./results/finetune/clip_large/ID_ImageNet1K/LoRA/finetuned_model.pth...
2024-06-16 05:19:32,304 | INFO | test_classify.py:151 | run_test_classify | ############ ID_ImageNet1K ############
2024-06-16 05:36:10,387 | INFO | test_classify.py:161 | run_test_classify | Accuracy on ID_ImageNet1K: 71.55
2024-06-16 05:36:10,387 | INFO | test_classify.py:151 | run_test_classify | ############ OOD_Sun ############
2024-06-16 05:37:57,356 | INFO | test_classify.py:161 | run_test_classify | Accuracy on OOD_Sun: 76.54
2024-06-16 05:37:57,356 | INFO | test_classify.py:151 | run_test_classify | ############ OOD_Places ############
2024-06-16 05:39:48,105 | INFO | test_classify.py:161 | run_test_classify | Accuracy on OOD_Places: 47.90
2024-06-16 05:39:48,105 | INFO | test_classify.py:151 | run_test_classify | ############ OOD_Texture ############
2024-06-16 05:40:51,008 | INFO | test_classify.py:161 | run_test_classify | Accuracy on OOD_Texture: 53.12
2024-06-16 05:40:51,008 | INFO | test_classify.py:164 | run_test_classify | ############ Summary ############
2024-06-16 05:40:51,008 | INFO | test_classify.py:166 | run_test_classify | Accuracy on ID_ImageNet1K: 71.55
2024-06-16 05:40:51,008 | INFO | test_classify.py:166 | run_test_classify | Accuracy on OOD_Sun: 76.54
2024-06-16 05:40:51,008 | INFO | test_classify.py:166 | run_test_classify | Accuracy on OOD_Places: 47.90
2024-06-16 05:40:51,008 | INFO | test_classify.py:166 | run_test_classify | Accuracy on OOD_Texture: 53.12
