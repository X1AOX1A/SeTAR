2024-06-16 05:01:24,057 | INFO | test_ood.py:29 | run_test_ood | ############ Test OOD Detection ############
2024-06-16 05:01:24,057 | INFO | test_ood.py:30 | run_test_ood | Loading CLIP model: openai/clip-vit-base-patch16...
2024-06-16 05:01:24,558 | INFO | test_ood.py:45 | run_test_ood | Loading CLIP model weights from ./results/finetune/clip_base/ID_ImageNet1K/SeTAR+FT/finetuned_model.pth...
2024-06-16 05:01:24,887 | INFO | test_ood.py:63 | run_test_ood | ############ ID dataset: ID_ImageNet1K, test set: 50000 images ############
2024-06-16 05:01:24,887 | INFO | test_ood.py:65 | run_test_ood | Computing scores for ID_ImageNet1K...
2024-06-16 05:03:34,962 | INFO | model_hub.py:304 | compute_scores | Took 130.07 s to run.
2024-06-16 05:03:35,142 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_iNaturalist, test set: 10000 images ############
2024-06-16 05:03:35,143 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_iNaturalist...
2024-06-16 05:04:03,313 | INFO | model_hub.py:304 | compute_scores | Took 28.17 s to run.
2024-06-16 05:04:03,386 | INFO | metrics.py:55 | print_metrics | OOD_iNaturalist - mcm_score
2024-06-16 05:04:03,386 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:04:03,386 | INFO | metrics.py:57 | print_metrics | & 33.04 & 93.49 & 98.55
2024-06-16 05:04:04,142 | INFO | metrics.py:55 | print_metrics | OOD_iNaturalist - gl_mcm_score
2024-06-16 05:04:04,142 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:04:04,142 | INFO | metrics.py:57 | print_metrics | & 21.51 & 95.46 & 98.95
2024-06-16 05:04:04,889 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_Sun, test set: 10000 images ############
2024-06-16 05:04:04,889 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_Sun...
2024-06-16 05:04:36,281 | INFO | model_hub.py:304 | compute_scores | Took 31.39 s to run.
2024-06-16 05:04:36,356 | INFO | metrics.py:55 | print_metrics | OOD_Sun - mcm_score
2024-06-16 05:04:36,356 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:04:36,356 | INFO | metrics.py:57 | print_metrics | & 29.38 & 93.96 & 98.60
2024-06-16 05:04:37,153 | INFO | metrics.py:55 | print_metrics | OOD_Sun - gl_mcm_score
2024-06-16 05:04:37,153 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:04:37,153 | INFO | metrics.py:57 | print_metrics | & 23.02 & 94.96 & 98.80
2024-06-16 05:04:38,011 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_Places, test set: 10000 images ############
2024-06-16 05:04:38,011 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_Places...
2024-06-16 05:05:05,116 | INFO | model_hub.py:304 | compute_scores | Took 27.1 s to run.
2024-06-16 05:05:05,190 | INFO | metrics.py:55 | print_metrics | OOD_Places - mcm_score
2024-06-16 05:05:05,190 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:05:05,190 | INFO | metrics.py:57 | print_metrics | & 37.75 & 91.34 & 97.83
2024-06-16 05:05:05,881 | INFO | metrics.py:55 | print_metrics | OOD_Places - gl_mcm_score
2024-06-16 05:05:05,882 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:05:05,882 | INFO | metrics.py:57 | print_metrics | & 32.27 & 91.96 & 97.92
2024-06-16 05:05:06,569 | INFO | test_ood.py:78 | run_test_ood | ############ OOD dataset: OOD_Texture, test set: 5640 images ############
2024-06-16 05:05:06,569 | INFO | test_ood.py:80 | run_test_ood | Computing scores for OOD_Texture...
2024-06-16 05:05:21,873 | INFO | model_hub.py:304 | compute_scores | Took 15.3 s to run.
2024-06-16 05:05:21,936 | INFO | metrics.py:55 | print_metrics | OOD_Texture - mcm_score
2024-06-16 05:05:21,936 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:05:21,936 | INFO | metrics.py:57 | print_metrics | & 54.45 & 87.42 & 98.24
2024-06-16 05:05:22,632 | INFO | metrics.py:55 | print_metrics | OOD_Texture - gl_mcm_score
2024-06-16 05:05:22,632 | INFO | metrics.py:56 | print_metrics |   FPR95 AUROC AUPR
2024-06-16 05:05:22,632 | INFO | metrics.py:57 | print_metrics | & 52.27 & 86.65 & 97.95
2024-06-16 05:05:23,300 | INFO | test_ood.py:98 | run_test_ood | ############ Metrics for mcm_score ############
2024-06-16 05:05:23,304 | INFO | metrics.py:76 | save_metrics | ############ Mean metrics ############
2024-06-16 05:05:23,305 | INFO | metrics.py:77 | save_metrics | 
                 FPR95  AUROC  AUPR
OOD dataset                        
OOD_iNaturalist  33.04  93.49 98.55
OOD_Sun          29.38  93.96 98.60
OOD_Places       37.75  91.34 97.83
OOD_Texture      54.45  87.42 98.24
Avg              38.66  91.55 98.30
2024-06-16 05:05:23,305 | INFO | metrics.py:78 | save_metrics | Metrics saved to ./results/finetune/clip_base/ID_ImageNet1K/SeTAR+FT/metrics_mcm_score_test.csv
2024-06-16 05:05:23,306 | INFO | metrics.py:87 | save_cutoffs | ############ Thresholds Cut-off ############
2024-06-16 05:05:23,307 | INFO | metrics.py:88 | save_cutoffs | 
    OOD dataset   Cutoff
OOD_iNaturalist 0.001109
        OOD_Sun 0.001109
     OOD_Places 0.001109
    OOD_Texture 0.001109
2024-06-16 05:05:23,307 | INFO | metrics.py:89 | save_cutoffs | Thresholds cutoff saved to ./results/finetune/clip_base/ID_ImageNet1K/SeTAR+FT/cutoffs_mcm_score_test.csv
2024-06-16 05:05:23,307 | INFO | test_ood.py:98 | run_test_ood | ############ Metrics for gl_mcm_score ############
2024-06-16 05:05:23,309 | INFO | metrics.py:76 | save_metrics | ############ Mean metrics ############
2024-06-16 05:05:23,310 | INFO | metrics.py:77 | save_metrics | 
                 FPR95  AUROC  AUPR
OOD dataset                        
OOD_iNaturalist  21.51  95.46 98.95
OOD_Sun          23.02  94.96 98.80
OOD_Places       32.27  91.96 97.92
OOD_Texture      52.27  86.65 97.95
Avg              32.27  92.26 98.40
2024-06-16 05:05:23,310 | INFO | metrics.py:78 | save_metrics | Metrics saved to ./results/finetune/clip_base/ID_ImageNet1K/SeTAR+FT/metrics_gl_mcm_score_test.csv
2024-06-16 05:05:23,311 | INFO | metrics.py:87 | save_cutoffs | ############ Thresholds Cut-off ############
2024-06-16 05:05:23,311 | INFO | metrics.py:88 | save_cutoffs | 
    OOD dataset   Cutoff
OOD_iNaturalist 0.002222
        OOD_Sun 0.002222
     OOD_Places 0.002222
    OOD_Texture 0.002222
2024-06-16 05:05:23,311 | INFO | metrics.py:89 | save_cutoffs | Thresholds cutoff saved to ./results/finetune/clip_base/ID_ImageNet1K/SeTAR+FT/cutoffs_gl_mcm_score_test.csv
2024-06-16 05:05:23,311 | INFO | test_ood.py:107 | run_test_ood | ############ Done! Test time: 3m 59s ############
2024-06-16 05:05:23,312 | INFO | test_classify.py:121 | run_test_classify | ############ Test Classification ############
2024-06-16 05:05:23,312 | INFO | test_classify.py:122 | run_test_classify | Loading CLIP model: openai/clip-vit-base-patch16...
2024-06-16 05:05:23,760 | INFO | test_classify.py:137 | run_test_classify | Loading clip model weights from ./results/finetune/clip_base/ID_ImageNet1K/SeTAR+FT/finetuned_model.pth...
2024-06-16 05:05:24,012 | INFO | test_classify.py:151 | run_test_classify | ############ ID_ImageNet1K ############
2024-06-16 05:08:38,382 | INFO | test_classify.py:161 | run_test_classify | Accuracy on ID_ImageNet1K: 67.07
2024-06-16 05:08:38,382 | INFO | test_classify.py:151 | run_test_classify | ############ OOD_Sun ############
2024-06-16 05:09:04,823 | INFO | test_classify.py:161 | run_test_classify | Accuracy on OOD_Sun: 77.97
2024-06-16 05:09:04,824 | INFO | test_classify.py:151 | run_test_classify | ############ OOD_Places ############
2024-06-16 05:09:30,128 | INFO | test_classify.py:161 | run_test_classify | Accuracy on OOD_Places: 46.60
2024-06-16 05:09:30,128 | INFO | test_classify.py:151 | run_test_classify | ############ OOD_Texture ############
2024-06-16 05:09:44,853 | INFO | test_classify.py:161 | run_test_classify | Accuracy on OOD_Texture: 43.48
2024-06-16 05:09:44,853 | INFO | test_classify.py:164 | run_test_classify | ############ Summary ############
2024-06-16 05:09:44,853 | INFO | test_classify.py:166 | run_test_classify | Accuracy on ID_ImageNet1K: 67.07
2024-06-16 05:09:44,853 | INFO | test_classify.py:166 | run_test_classify | Accuracy on OOD_Sun: 77.97
2024-06-16 05:09:44,854 | INFO | test_classify.py:166 | run_test_classify | Accuracy on OOD_Places: 46.60
2024-06-16 05:09:44,854 | INFO | test_classify.py:166 | run_test_classify | Accuracy on OOD_Texture: 43.48
